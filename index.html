<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mic Check â€” Can You Hear Me?</title>
    <!-- 
        Mic Check - Browser Microphone Diagnostic Tool
        Copyright (c) 2026 Matt Read
        Licensed under the MIT License
        https://github.com/mread/mic-check
    -->
    <meta name="description" content="Free tool to test your microphone, check browser permissions, and diagnose why your mic isn't working. No data collected, runs entirely in your browser.">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Mic Check â€” Is Your Microphone Working?">
    <meta property="og:description" content="Free browser-based microphone diagnostic tool. Test your mic, check permissions, troubleshoot issues.">
    <meta property="og:type" content="website">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ¤</text></svg>">
    
    <style>
        /* System font stacks - no external requests for privacy */
        
        :root {
            --bg: #f8f9fa;
            --bg-card: #ffffff;
            --bg-muted: #f1f3f4;
            --bg-elevated: #ffffff;
            --text: #202124;
            --text-secondary: #5f6368;
            --text-muted: #9aa0a6;
            --border: #dadce0;
            --border-light: #eee;
            --accent: #1a73e8;
            --accent-light: #e8f0fe;
            --problem: #d93025;
            --problem-light: #fce8e6;
            --ok: #1e8e3e;
            --success: #1e8e3e;
            --success-light: #e6f4ea;
            --warning: #f9ab00;
            --warning-light: #fef7e0;
            --shadow: 0 1px 2px rgba(0,0,0,0.1);
            --shadow-lg: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }
        
        /* Header */
        header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .logo {
            font-size: 4rem;
            margin-bottom: 0.5rem;
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .tagline {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .privacy-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--bg-muted);
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 1rem;
        }
        
        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .card-icon {
            font-size: 2rem;
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .card-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Homepage Layout */
        .home-layout {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .home-secondary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
        }
        
        @media (max-width: 768px) {
            .home-secondary {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .home-secondary {
                grid-template-columns: 1fr;
            }
        }
        
        /* Primary Action Card */
        .primary-action {
            background: var(--bg-card);
            border: 2px solid var(--accent);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }
        
        /* Journey Cards */
        .journey-card {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }
        
        .journey-card:hover {
            border-color: var(--accent);
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .journey-icon {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }
        
        .journey-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .journey-desc {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }
        
        /* Buttons */
        .btn {
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: var(--accent);
            color: white;
        }
        
        .btn-primary:hover {
            filter: brightness(1.1);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text);
            border: 1px solid var(--border);
        }
        
        .btn-secondary:hover {
            border-color: var(--accent);
        }
        
        .btn-large {
            width: 100%;
            padding: 1.25rem 2rem;
            font-size: 1.1rem;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-group {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }
        
        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }
        
        /* Device List - clickable rows to select microphone */
        .device-list-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        .device-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .device-list-title {
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .device-count-badge {
            font-size: 0.75rem;
            padding: 0.2rem 0.5rem;
            background: var(--bg-muted);
            border-radius: 4px;
            color: var(--text-muted);
        }
        
        .device-list-picker {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .device-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.75rem;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.15s ease;
            background: white;
        }
        
        .device-item:hover {
            background: var(--bg-muted);
            border-color: var(--border);
        }
        
        .device-item.active {
            background: var(--accent-light);
            border-color: var(--accent);
            border-left: 3px solid var(--accent);
        }
        
        .device-item.active .device-label {
            font-weight: 600;
        }
        
        .device-item.placeholder {
            cursor: default;
            opacity: 0.6;
        }
        
        .device-item.placeholder:hover {
            background: white;
            border-color: var(--border-light);
        }
        
        .device-icon {
            font-size: 1.1rem;
            flex-shrink: 0;
        }
        
        .device-label {
            flex-grow: 1;
            font-size: 0.9rem;
        }
        
        .device-badge {
            font-size: 0.7rem;
            padding: 0.15rem 0.4rem;
            border-radius: 3px;
            background: var(--bg-muted);
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }
        
        .device-badge.default {
            background: var(--bg-muted);
            color: var(--text);
            font-weight: 600;
        }
        
        .device-badge.comms {
            background: var(--accent-light);
            color: var(--accent);
        }
        
        .device-status {
            font-size: 0.75rem;
            color: var(--success);
            font-weight: 600;
        }
        
        /* Multi-Mic Monitor Panel */
        .mic-monitor-panel {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }
        
        .mic-monitor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            padding-top: 0.5rem;
        }
        
        /* Section header style per ux-approach.md Principle #5 */
        .mic-monitor-title {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }
        
        .mic-monitor-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .mic-monitor-row {
            display: grid;
            grid-template-columns: auto auto 1fr minmax(120px, 180px);
            gap: 0.75rem;
            align-items: center;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: white;
            transition: all 0.15s ease;
        }
        
        .mic-monitor-row.monitoring {
            border-color: var(--accent);
            background: var(--accent-light);
        }
        
        .mic-monitor-row.primary {
            border-left: 3px solid var(--accent);
        }
        
        .mic-monitor-row.placeholder {
            grid-template-columns: auto 1fr;
            opacity: 0.6;
        }
        
        .mic-monitor-row.error {
            border-color: var(--problem);
            background: var(--problem-light);
        }
        
        .mic-monitor-toggle {
            flex-shrink: 0;
        }
        
        .mic-monitor-label {
            font-size: 0.9rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .mic-monitor-label .device-aliases {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-left: 0.5rem;
        }
        
        /* Inline level meter for mic monitor rows */
        .mic-level-meter {
            height: 20px;
            background: linear-gradient(90deg, 
                #1a3d1a 0%, #1a3d1a 60%,
                #3d3d1a 60%, #3d3d1a 85%,
                #3d1a1a 85%, #3d1a1a 100%
            );
            border-radius: 3px;
            overflow: hidden;
            position: relative;
            border: 1px solid #333;
        }
        
        .mic-level-meter-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, 
                #22c55e 0%, #22c55e 60%,
                #eab308 60%, #eab308 85%,
                #ef4444 85%, #ef4444 100%
            );
            border-radius: 2px;
            transition: clip-path 0.03s ease;
            clip-path: inset(0 100% 0 0);
        }
        
        .mic-level-meter-text {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.7rem;
            font-weight: 600;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        
        .mic-level-meter.inactive {
            opacity: 0.3;
        }
        
        .mic-level-meter.inactive .mic-level-meter-text {
            color: var(--text-muted);
            text-shadow: none;
        }
        
        /* Error state tooltip styling */
        .mic-monitor-row.error .mic-level-meter-text {
            color: var(--problem);
            cursor: help;
        }
        
        /* Custom tooltip using data-tooltip to avoid duplicate native tooltips */
        .mic-level-meter-text[data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            right: 0;
            top: 100%;
            margin-top: 0.25rem;
            padding: 0.5rem 0.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            font-size: 0.8rem;
            font-weight: normal;
            color: var(--text);
            white-space: nowrap;
            z-index: 10;
        }
        
        /* Mobile: stack label and meter */
        @media (max-width: 600px) {
            .mic-monitor-row {
                grid-template-columns: auto auto 1fr;
                grid-template-rows: auto auto;
            }
            
            .mic-level-meter {
                grid-column: 1 / -1;
                height: 16px;
            }
        }
        
        /* Diagnostic Results Table - stable structure, only status icons change */
        .diagnostic-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0.5rem 0 1rem;
        }
        
        .diagnostic-table thead {
            display: none; /* Hide header row, structure is self-evident */
        }
        
        .diagnostic-table tr {
            border-bottom: 1px solid var(--border);
        }
        
        .diagnostic-table tr:last-child {
            border-bottom: none;
        }
        
        /* Section header rows get extra spacing */
        .diagnostic-table tr.diag-section-row {
            border-bottom: none;
        }
        
        /* Rows after section headers get top border instead */
        .diagnostic-table tr.diag-section-row + tr {
            border-top: 1px solid var(--border);
        }
        
        .diagnostic-table td {
            padding: 0.75rem 0.5rem;
            vertical-align: middle;
        }
        
        .diag-col-status, .diag-status {
            width: 2.5rem;
            text-align: right;
            padding-right: 0.25rem;
        }
        
        .diag-icon {
            font-size: 1.1rem;
        }
        
        .diag-name {
            /* Hidden - we use single-line display with self-explanatory messages */
            /* Kept in DOM for layout stability (Principle #1) */
            display: none;
        }
        
        .diag-detail {
            font-size: 0.9rem;
            color: var(--text);
            font-weight: 500;
        }
        
        /* Section header row within table */
        .diag-section-row td {
            padding-top: 1rem;
            padding-bottom: 0.4rem;
            border-bottom: none;
        }
        
        .diag-section-header {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }
        
        /* Row states - subtle background changes */
        .diagnostic-table tr.pass td {
            background: var(--success-light);
        }
        
        .diagnostic-table tr.fail td {
            background: var(--problem-light);
        }
        
        .diagnostic-table tr.warn td {
            background: var(--warning-light);
        }
        
        .diagnostic-table tr.running td {
            background: var(--accent-light);
        }
        
        /* Inline action/fix area within each diagnostic row */
        .diag-action {
            margin-top: 0.5rem;
            font-size: 0.85rem;
        }
        
        .diag-action ol {
            margin: 0.25rem 0 0 1.25rem;
            padding: 0;
        }
        
        .diag-action li {
            margin: 0.2rem 0;
        }
        
        .diag-action .btn {
            margin-top: 0.5rem;
        }
        
        .diag-action-hint {
            color: var(--text-secondary);
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }
        
        /* Quality section - inactive until prerequisites pass */
        .diag-quality-section.inactive {
            opacity: 0.5;
        }
        
        .diag-quality-section.inactive .diag-name,
        .diag-quality-section.inactive .diag-detail {
            color: var(--text-muted);
        }
        
        /* Inline level meter for noise/voice tests - reuses mic-level-meter styling */
        /* Uses .mic-level-meter.inline for compact inline display in diagnostics */
        .mic-level-meter.inline {
            height: 12px;
            margin-top: 0.5rem;
            min-width: 100px;
        }
        
        .mic-level-meter.inline .mic-level-meter-text {
            font-size: 0.65rem;
            right: 0.25rem;
        }
        
        /* Recording indicator */
        .diag-recording {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--problem);
            font-weight: 500;
        }
        
        .diag-recording-dot {
            width: 8px;
            height: 8px;
            background: var(--problem);
            border-radius: 50%;
            animation: pulse 1s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
        
        /* Status Indicators */
        .status-card {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem 1.25rem;
            border-radius: 12px;
            margin: 1rem 0;
            background: var(--bg-muted);
        }
        
        .status-card.success {
            background: #e6f4ea;
        }
        
        .status-card.problem, .status-card.warning, .status-card.error {
            background: var(--problem-light);
        }
        
        .status-card.info {
            background: var(--accent-light);
        }
        
        .status-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .status-text {
            flex: 1;
        }
        
        .status-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .status-detail {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* Visualizer */
        .visualizer-container {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .level-bar-container {
            height: 32px;
            background: linear-gradient(90deg, 
                #1a3d1a 0%, #1a3d1a 60%,
                #3d3d1a 60%, #3d3d1a 85%,
                #3d1a1a 85%, #3d1a1a 100%
            );
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            border: 1px solid #333;
        }
        
        .level-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, 
                #22c55e 0%, #22c55e 60%,
                #eab308 60%, #eab308 85%,
                #ef4444 85%, #ef4444 100%
            );
            border-radius: 3px;
            transition: clip-path 0.03s ease;
            clip-path: inset(0 100% 0 0);
        }
        
        .level-text {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
        }
        
        /* Device List */
        .device-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            background: var(--bg-elevated);
            border-radius: 8px;
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }
        
        .device-item.active {
            background: var(--success-light);
            border: 1px solid var(--success);
        }
        
        /* Info Sections */
        .info-box {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            margin: 1rem 0;
        }
        
        .info-box h4 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .info-box p, .info-box ul {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .info-box ul {
            margin-left: 1.25rem;
        }
        
        .info-box li {
            margin: 0.25rem 0;
        }
        
        /* Back Link */
        .back-link {
            display: inline-block;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            padding: 0.25rem 0;
        }
        
        .back-link:hover {
            color: var(--accent);
        }
        
        /* Privacy Section */
        .privacy-section {
            background: var(--bg-muted);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            margin: 1.5rem 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .privacy-section p {
            margin: 0;
            line-height: 1.7;
        }
        
        /* Screens */
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
            flex-shrink: 0;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.3s;
            border-radius: 28px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .toggle-switch input:checked + .toggle-slider {
            background-color: var(--accent);
        }
        
        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }
        
        /* Playback Feature Styles */
        .playback-section {
            padding: 1rem;
            background: var(--bg-elevated);
            border-radius: 12px;
            border: 1px solid var(--border);
        }
        
        .countdown-display {
            font-size: 4rem;
            font-weight: bold;
            color: var(--accent);
            animation: countdownPulse 1s ease-in-out infinite;
        }
        
        @keyframes countdownPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        .recording-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--problem);
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .recording-dot {
            width: 12px;
            height: 12px;
            background: var(--problem);
            border-radius: 50%;
            animation: recordingPulse 1s ease-in-out infinite;
        }
        
        @keyframes recordingPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        /* Playback Mode Toggle - gaming audio software inspired */
        .playback-mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--bg-muted) 0%, #e8eaed 100%);
            border: 1px solid var(--border);
            border-radius: 10px;
            transition: all 0.2s ease;
        }
        
        .playback-mode-toggle:hover {
            border-color: var(--accent);
            box-shadow: 0 2px 8px rgba(26, 115, 232, 0.1);
        }
        
        .playback-mode-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .playback-mode-icon {
            font-size: 1.5rem;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));
        }
        
        .playback-mode-text {
            line-height: 1.3;
        }
        
        .playback-mode-text strong {
            font-size: 0.95rem;
            color: var(--text);
        }
        
        .playback-mode-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .playback-mode-error {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            margin-bottom: 0.75rem;
            background: var(--warning-light);
            border-radius: 6px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .playback-mode-error .error-icon {
            font-size: 1rem;
        }
        
        /* Disabled state for toggle when one mode unavailable */
        .playback-mode-toggle.disabled {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .playback-mode-toggle.disabled .toggle-switch {
            opacity: 0.5;
        }
        
        /* Collapsible sections */
        .collapsible-section {
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-top: 0.5rem;
            overflow: hidden;
        }
        
        .collapsible-header {
            padding: 0.75rem 1rem;
            background: var(--bg-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .collapsible-header:hover {
            background: var(--border);
        }
        
        .collapsible-content {
            padding: 1rem;
            display: none;
        }
        
        .collapsible-section.open .collapsible-content {
            display: block;
        }
        
        .collapsible-arrow {
            transition: transform 0.2s;
        }
        
        .collapsible-section.open .collapsible-arrow {
            transform: rotate(180deg);
        }
        
        /* Table */
        .info-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .info-table th, .info-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .info-table th {
            font-weight: 600;
            background: var(--bg-elevated);
        }
        
        /* Monitor Screen Styles */
        .monitor-viz-section {
            margin-bottom: 1rem;
        }
        
        .monitor-viz-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .monitor-viz-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }
        
        .monitor-level-container {
            margin-top: 0.5rem;
        }
        
        /* Studio Monitor Screen - DAW-inspired layout */
        .studio-layout {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        /* Transport Bar - device selection and controls */
        .studio-transport {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            flex-wrap: wrap;
        }
        
        .studio-transport-device {
            flex: 1;
            min-width: 200px;
        }
        
        .studio-transport-device select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.9rem;
            background: white;
        }
        
        .studio-transport-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .transport-btn {
            width: 44px;
            height: 44px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--bg-elevated);
            font-size: 1.25rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
        }
        
        .transport-btn:hover {
            border-color: var(--accent);
            background: var(--accent-light);
        }
        
        .transport-btn.recording {
            background: var(--problem);
            border-color: var(--problem);
            color: white;
            animation: recordPulse 1s ease-in-out infinite;
        }
        
        .transport-btn.playing {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }
        
        .transport-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        @keyframes recordPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .transport-time {
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 1.1rem;
            font-weight: 600;
            min-width: 70px;
            text-align: center;
            padding: 0.5rem;
            background: var(--bg-muted);
            border-radius: 6px;
        }
        
        .transport-status {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .transport-status.recording {
            color: var(--problem);
            font-weight: 600;
        }
        
        .transport-status.playing {
            color: var(--accent);
            font-weight: 600;
        }
        
        /* Main visualization area */
        .studio-viz-main {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
        }
        
        .studio-section-label {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }
        
        /* Help icon and tooltip for visualization sections */
        .studio-help-icon {
            font-size: 0.65rem;
            color: var(--text-muted);
            cursor: help;
            opacity: 0.6;
            transition: opacity 0.15s;
            position: relative;
            text-transform: none;
            letter-spacing: normal;
        }
        
        .studio-help-icon:hover {
            opacity: 1;
        }
        
        .studio-help-tooltip {
            display: none;
            position: absolute;
            top: 1.5rem;
            left: 0;
            z-index: 100;
            background: var(--bg-elevated, #ffffff);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            min-width: 280px;
            max-width: min(340px, calc(100vw - 2rem));
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            font-size: 0.8rem;
            font-weight: 400;
            line-height: 1.5;
            color: var(--text-secondary);
            text-transform: none;
            letter-spacing: normal;
        }
        
        .studio-help-icon:hover .studio-help-tooltip,
        .studio-help-icon:focus .studio-help-tooltip {
            display: block;
        }
        
        .studio-help-tooltip strong {
            color: var(--text);
            display: block;
            margin-bottom: 0.4rem;
        }
        
        .studio-help-tooltip ul {
            margin: 0.5rem 0 0 0;
            padding-left: 1.1rem;
        }
        
        .studio-help-tooltip li {
            margin-bottom: 0.25rem;
        }
        
        .studio-help-tooltip li:last-child {
            margin-bottom: 0;
        }
        
        /* Mobile: prevent tooltip overflow */
        @media (max-width: 600px) {
            .studio-help-tooltip {
                min-width: 200px;
                left: auto;
                right: 0;
            }
        }
        
        /* =================================================================
           STUDIO VISUALIZATION WIDGETS
           
           Dimensions (desktop):
           - Spectrogram:  700Ã—180px (frequency over time, scrolls left)
           - Spectrum:     700Ã—80px  (32 bars, 80Hz-16kHz)
           - Oscilloscope: 700Ã—100px (waveform, ~80ms window)
           
           Dimensions (mobile â‰¤600px):
           - Spectrogram:  100%Ã—120px
           - Spectrum:     100%Ã—60px
           - Oscilloscope: 100%Ã—60px
           
           All widgets use a 32px left axis column for alignment.
           Canvas elements have explicit width/height attributes to prevent
           scaling artifacts. CSS controls display size.
           ================================================================= */
        
        /* Shared axis column width for widget alignment */
        .studio-viz-axis {
            width: 32px;
            min-width: 32px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-size: 0.65rem;
            color: var(--text-muted);
            padding: 2px 0;
            text-align: right;
        }
        
        /* Spectrogram â€” 700Ã—180px desktop, 120px mobile */
        .studio-spectrogram {
            margin-bottom: 1.25rem;
        }
        
        .studio-spectrogram-container {
            display: flex;
            gap: 0.5rem;
        }
        
        .studio-spectrogram-axis {
            /* Inherits from .studio-viz-axis, add any spectrogram-specific styles here */
        }
        
        .studio-spectrogram-canvas-wrap {
            flex: 1;
            position: relative;
        }
        
        .studio-spectrogram-canvas {
            width: 100%;
            height: 180px;  /* Desktop: 180px */
            border-radius: 4px;
            background: #0a0a0a;
        }
        
        .studio-spectrogram-time {
            text-align: center;
            font-size: 0.65rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }
        
        /* Spectrum Analyzer â€” 700Ã—80px desktop, 60px mobile
           Bar graph showing frequency content in real-time */
        .studio-spectrum {
            margin-bottom: 1.25rem;
        }
        
        .studio-spectrum-container {
            display: flex;
            gap: 0.5rem;
        }
        
        .studio-spectrum-axis {
            /* Inherits from .studio-viz-axis, empty for spectrum (dB not shown) */
        }
        
        .studio-spectrum-main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .studio-spectrum-canvas-wrap {
            flex: 1;
            position: relative;
        }
        
        .studio-spectrum-canvas {
            width: 100%;
            height: 80px;  /* Desktop: 80px */
            border-radius: 4px;
            background: #0a0a0a;
        }
        
        .studio-spectrum-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.65rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
            padding: 0 2px;
        }
        
        /* Waveform + Meter Row â€” oscilloscope on left, vertical meter on right */
        .studio-waveform-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.25rem;
            align-items: stretch;
        }
        
        /* Oscilloscope (Waveform) â€” 700Ã—100px desktop, 60px mobile
           Shows ~80ms of audio, auto-scaled so speech fills ~70% height.
           Matches spectrogram width for visual alignment. */
        .studio-oscilloscope {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .studio-oscilloscope-container {
            display: flex;
            gap: 0.5rem;
            flex: 1;
        }
        
        .studio-oscilloscope-axis {
            /* Inherits from .studio-viz-axis, add any oscilloscope-specific styles here */
        }
        
        .studio-oscilloscope-canvas-wrap {
            flex: 1;
            position: relative;
        }
        
        .studio-oscilloscope-canvas {
            width: 100%;
            height: 100px;  /* Desktop: 100px (shorter than spectrogram's 180px) */
            border-radius: 4px;
            background: #0a0a0a;
        }
        
        /* Vertical Level Meters */
        .studio-meters-vertical {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
        }
        
        .studio-vmeter-container {
            display: flex;
            gap: 6px;
            flex: 1;
            padding-top: 4px;
        }
        
        .studio-vmeter-col {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .studio-vmeter-bar {
            width: 22px;
            flex: 1;
            min-height: 80px;
            background: linear-gradient(to top, 
                #1a3d1a 0%, #1a3d1a 60%,
                #3d3d1a 60%, #3d3d1a 85%,
                #3d1a1a 85%, #3d1a1a 100%
            );
            border-radius: 3px;
            overflow: hidden;
            position: relative;
            border: 1px solid #333;
        }
        
        .studio-vmeter-fill {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, 
                #22c55e 0%, #22c55e 60%,
                #eab308 60%, #eab308 85%,
                #ef4444 85%, #ef4444 100%
            );
            border-radius: 2px;
            transition: clip-path 0.03s ease;
            clip-path: inset(100% 0 0 0);
        }
        
        .studio-vmeter-peak {
            position: absolute;
            left: 0;
            width: 100%;
            height: 2px;
            background: white;
            opacity: 0.9;
            transition: bottom 0.05s ease;
        }
        
        .studio-vmeter-label {
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-muted);
        }
        
        .studio-vmeter-db {
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        /* Readouts row */
        .studio-readouts {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .studio-readout {
            flex: 1;
            min-width: 140px;
            padding: 0.75rem 1rem;
            background: var(--bg-muted);
            border-radius: 8px;
            text-align: center;
        }
        
        .studio-readout-label {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.25rem;
        }
        
        .studio-readout-value {
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
        }
        
        .studio-readout-value.good {
            color: var(--success);
        }
        
        .studio-readout-value.warn {
            color: var(--warning);
        }
        
        .studio-readout-value.bad {
            color: var(--problem);
        }
        
        /* Recording Strip */
        .studio-recording {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
        }
        
        .studio-recording-strip {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .studio-recording-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            min-width: 80px;
        }
        
        .studio-recording-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--text-muted);
        }
        
        .studio-recording-dot.active {
            background: var(--problem);
            animation: recordPulse 1s ease-in-out infinite;
        }
        
        .studio-recording-time {
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .studio-recording-waveform {
            flex: 1;
            height: 48px;
            background: var(--bg-muted);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }
        
        .studio-recording-waveform canvas {
            width: 100%;
            height: 100%;
        }
        
        .studio-recording-empty {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-muted);
            font-size: 0.8rem;
        }
        
        .studio-recording-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .studio-recording-btn {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-elevated);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.15s ease;
        }
        
        .studio-recording-btn:hover {
            border-color: var(--accent);
            background: var(--accent-light);
        }
        
        .studio-recording-btn.playing {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        
        .studio-recording-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        /* Processing toggle in recording strip */
        .studio-processing-toggle {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border-light);
            font-size: 0.85rem;
        }
        
        .studio-processing-label {
            color: var(--text-secondary);
        }
        
        .studio-processing-toggle .toggle-switch {
            transform: scale(0.85);
        }
        
        /* Permission prompt for studio */
        .studio-permission-prompt {
            text-align: center;
            padding: 2rem;
        }
        
        .studio-permission-prompt p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        /* Mobile adjustments for studio */
        @media (max-width: 600px) {
            .studio-transport {
                flex-direction: column;
                align-items: stretch;
            }
            
            .studio-transport-device {
                min-width: auto;
            }
            
            .studio-transport-controls {
                justify-content: center;
            }
            
            .studio-spectrogram-canvas {
                height: 120px;  /* Mobile: reduced from 180px */
            }
            
            .studio-oscilloscope-canvas {
                height: 60px;   /* Mobile: reduced from 100px */
            }
            
            .studio-spectrum-canvas {
                height: 60px;   /* Mobile: reduced from 80px */
            }
            
            .studio-waveform-row {
                flex-direction: column;
            }
            
            .studio-meters-vertical {
                flex-direction: row;
                justify-content: center;
                gap: 1rem;
            }
            
            .studio-vmeter-container {
                padding-top: 0;
            }
            
            .studio-vmeter-bar {
                height: 60px;
                min-height: 60px;
            }
            
            .studio-readouts {
                flex-direction: column;
            }
            
            .studio-recording-strip {
                flex-wrap: wrap;
            }
            
            .studio-recording-waveform {
                order: 3;
                flex: 1 1 100%;
            }
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
            font-size: 0.85rem;
        }
        
        footer a {
            color: var(--accent);
            text-decoration: none;
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.75rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">ðŸŽ¤</div>
            <h1>Mic Check</h1>
            <p class="tagline">Can you hear me?</p>
            <div class="privacy-badge">
                ðŸ”’ 100% Private â€” No data leaves your browser
            </div>
        </header>

        <!-- Screen 1: Home -->
        <div id="screen-home" class="screen active">
            <div class="home-layout">
                <!-- Primary: Test Your Microphone -->
                <div class="primary-action">
                    <div style="font-size: 3rem; margin-bottom: 0.5rem;">ðŸŽ¤</div>
                    <h2 style="font-size: 1.5rem; margin-bottom: 0.5rem;">Test Your Microphone</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                        Check if it's working, fix it if it's not
                    </p>
                    <button id="btn-start-test" class="btn btn-primary btn-large">
                        Start Test
                    </button>
                </div>
                
                <!-- Secondary Options -->
                <div class="home-secondary">
                    <div class="journey-card" data-journey="monitor" role="button" tabindex="0">
                        <div class="journey-icon">ðŸ“¡</div>
                        <div class="journey-title">Monitor</div>
                        <div class="journey-desc">Visualize your audio</div>
                    </div>
                    
                    <div class="journey-card" data-journey="studio" role="button" tabindex="0">
                        <div class="journey-icon">ðŸŽšï¸</div>
                        <div class="journey-title">Studio</div>
                        <div class="journey-desc">Pro audio monitoring</div>
                    </div>
                    
                    <div class="journey-card" data-journey="privacy" role="button" tabindex="0">
                        <div class="journey-icon">ðŸ”</div>
                        <div class="journey-title">Privacy Check</div>
                        <div class="journey-desc">Is my browser listening?</div>
                    </div>
                </div>
            </div>
            
            <div class="privacy-section">
                <p>
                    ðŸ”’ <strong>100% Private:</strong> No audio recorded. No data sent. No cookies.
                </p>
            </div>
        </div>

        <!-- Screen 2: Microphone Test (Unified Test + Troubleshoot) -->
        <div id="screen-mic-test" class="screen">
            <a href="#" class="back-link">â† Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ðŸŽ¤</span>
                    <div>
                        <div class="card-title">Microphone Test</div>
                        <div class="card-subtitle" id="test-subtitle">Checking your microphone...</div>
                    </div>
                </div>
                
                <!-- Multi-Mic Monitor Panel -->
                <!-- Toggle switches to enable/disable monitoring per microphone -->
                <div id="mic-monitor-panel" class="mic-monitor-panel">
                    <div class="mic-monitor-header">
                        <span class="mic-monitor-title">Toggle microphones to monitor:</span>
                        <span id="device-count-badge" class="device-count-badge">Checking...</span>
                    </div>
                    <div id="mic-monitor-list" class="mic-monitor-list">
                        <div class="mic-monitor-row placeholder">
                            <span class="device-icon">â³</span>
                            <span class="device-label">Detecting microphones...</span>
                        </div>
                    </div>
                </div>
                
                <!-- Diagnostic Results Table - OUTPUT area, stable structure -->
                <!-- Reading order: Test â†’ Result (like "Browser Support: âœ“") -->
                <table id="diagnostic-table" class="diagnostic-table">
                    <thead>
                        <tr>
                            <th class="diag-col-test">Test</th>
                            <th class="diag-col-status">Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="diag-section-row">
                            <td colspan="2" class="diag-section-header">System</td>
                        </tr>
                        <tr id="diag-row-browser-support">
                            <td class="diag-test">
                                <div class="diag-name">Browser Support</div>
                                <div class="diag-detail"></div>
                                <div class="diag-action" style="display: none;"></div>
                            </td>
                            <td class="diag-status"><span class="diag-icon">â¸ï¸</span></td>
                        </tr>
                        <tr id="diag-row-permission-state">
                            <td class="diag-test">
                                <div class="diag-name">Permission Status</div>
                                <div class="diag-detail"></div>
                                <div class="diag-action" style="display: none;"></div>
                            </td>
                            <td class="diag-status"><span class="diag-icon">â¸ï¸</span></td>
                        </tr>
                        <tr id="diag-row-device-enumeration">
                            <td class="diag-test">
                                <div class="diag-name">Microphone Detection</div>
                                <div class="diag-detail"></div>
                                <div class="diag-action" style="display: none;"></div>
                            </td>
                            <td class="diag-status"><span class="diag-icon">â¸ï¸</span></td>
                        </tr>
                        <tr class="diag-section-row">
                            <td colspan="2" class="diag-section-header">Device</td>
                        </tr>
                        <tr id="diag-row-stream-acquisition">
                            <td class="diag-test">
                                <div class="diag-name">Microphone Access</div>
                                <div class="diag-detail"></div>
                                <div class="diag-action" style="display: none;"></div>
                            </td>
                            <td class="diag-status"><span class="diag-icon">â¸ï¸</span></td>
                        </tr>
                        <tr id="diag-row-signal-detection">
                            <td class="diag-test">
                                <div class="diag-name">Audio Signal</div>
                                <div class="diag-detail"></div>
                                <div class="diag-action" style="display: none;"></div>
                            </td>
                            <td class="diag-status"><span class="diag-icon">â¸ï¸</span></td>
                        </tr>
                        <tr class="diag-section-row diag-quality-section inactive" id="diag-section-quality">
                            <td colspan="2" class="diag-section-header">Signal Quality</td>
                        </tr>
                        <tr id="diag-row-noise-floor" class="diag-quality-section inactive">
                            <td class="diag-test">
                                <div class="diag-name">Background Noise</div>
                                <div class="diag-detail">Waiting for audio signal test</div>
                                <div class="diag-action" style="display: none;"></div>
                            </td>
                            <td class="diag-status"><span class="diag-icon">â¸ï¸</span></td>
                        </tr>
                        <tr id="diag-row-voice-level" class="diag-quality-section inactive">
                            <td class="diag-test">
                                <div class="diag-name">Voice Level</div>
                                <div class="diag-detail">Waiting for noise test</div>
                                <div class="diag-action" style="display: none;"></div>
                            </td>
                            <td class="diag-status"><span class="diag-icon">â¸ï¸</span></td>
                        </tr>
                    </tbody>
                </table>
                
                <!-- Quality Test Results Summary (shown after all tests complete) -->
                <div id="quality-summary" style="display: none; margin-top: 1.5rem; padding: 1.5rem; border-radius: 8px; text-align: center;">
                    <div id="quality-summary-icon" style="font-size: 3rem; margin-bottom: 0.5rem;"></div>
                    <div id="quality-summary-title" style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.25rem;"></div>
                    <div id="quality-summary-detail" style="color: var(--text-secondary); font-size: 0.9rem;"></div>
                </div>
                
                <!-- Stereo Issue Warning (shown if detected) -->
                <div id="stereo-issue-warning" style="display: none; margin-top: 1rem; background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem; border-radius: 0 8px 8px 0;">
                    <strong style="display: block; margin-bottom: 0.5rem;">ðŸ”§ Stereo Configuration Issue (Fixable!)</strong>
                    <p style="margin-bottom: 0.75rem; color: var(--text-secondary);">
                        Your mic reports as stereo but only one channel has audio. 
                        This causes browsers to mix a silent channel with your voice, cutting volume by ~50%.
                    </p>
                    <details>
                        <summary style="cursor: pointer; color: var(--accent); font-weight: 500;">How to fix</summary>
                        <div style="margin-top: 0.75rem; font-size: 0.9rem; color: var(--text-secondary);">
                            <strong>Windows:</strong> Sound Settings â†’ Recording â†’ Right-click mic â†’ Properties â†’ Advanced â†’ Change to "1 channel"<br><br>
                            <strong>macOS:</strong> Audio MIDI Setup â†’ Select interface â†’ Configure as mono<br><br>
                            <strong>Then:</strong> Come back and run this test again to verify the fix.
                        </div>
                    </details>
                </div>
                
                <!-- Final Actions (shown after quality tests complete) -->
                <div id="quality-actions" style="display: none; margin-top: 1.5rem; display: flex; gap: 0.75rem; flex-wrap: wrap;">
                    <button id="btn-test-again" class="btn btn-primary">Test Again</button>
                    <button id="btn-download-report" class="btn" style="background: var(--bg-muted); border: 1px solid var(--border);">Download Report</button>
                    <a href="#" class="btn" style="background: var(--bg-muted); border: 1px solid var(--border);">â† Back to Home</a>
                </div>
                
                <!-- Action Buttons (retry only - permission button is now inline) -->
                <div id="test-actions" style="margin-top: 1rem;">
                    <button id="btn-retry-test" class="btn btn-secondary btn-large" style="display: none;">
                        ðŸ”„ Try Again
                    </button>
                </div>
            </div>
            
            <!-- Detected Devices (shown after permission) -->
            <div id="detected-devices" class="card" style="display: none;">
                <div class="card-header">
                    <span class="card-icon">ðŸŽ¤</span>
                    <div>
                        <div class="card-title">Detected Microphones</div>
                        <div class="card-subtitle" id="device-count">Loading...</div>
                    </div>
                </div>
                <div id="device-list">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Screen 3: Level Check -->
        <div id="screen-level-check" class="screen">
            <a href="#" class="back-link">â† Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ðŸ“Š</span>
                    <div>
                        <div class="card-title">Microphone Level Check</div>
                        <div class="card-subtitle">Are you loud enough to be heard clearly?</div>
                    </div>
                </div>
                
                
                <div id="quality-intro">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        <strong>Are people saying you're too quiet in calls?</strong> This test diagnoses common issues 
                        like stereo misconfiguration, insufficient signal, and background noise.
                    </p>
                    
                    <details style="margin-bottom: 1.5rem; font-size: 0.9rem;">
                        <summary style="cursor: pointer; color: var(--accent); font-weight: 500;">â„¹ï¸ What this test does</summary>
                        <div style="margin-top: 0.75rem; padding: 1rem; background: var(--bg-muted); border-radius: 8px;">
                            <p style="margin-bottom: 0.75rem;"><strong>We check if your mic provides enough signal</strong> for browser apps to work with. 
                            Most apps (Google Meet, Zoom web, Discord) use Auto Gain Control (AGC) which automatically adjusts your volume.</p>
                            
                            <p style="margin-bottom: 0.75rem;"><strong>Common issues we detect:</strong></p>
                            <ul style="margin: 0 0 0.75rem 1.25rem; color: var(--text-secondary);">
                                <li><strong>Stereo misconfiguration</strong> â€” A mono mic set as stereo causes 50% volume loss in some browsers</li>
                                <li><strong>Signal too weak</strong> â€” Even AGC can't compensate if gain is too low</li>
                                <li><strong>Background noise</strong> â€” Makes it hard for others to hear you clearly</li>
                            </ul>
                            
                            <p style="margin-bottom: 0.75rem;"><strong>If issues are found:</strong> Our upcoming <em>Gain Staging</em> guide will help you 
                            optimize your hardware and OS settings for the best results.</p>
                            
                            <p style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--border); font-size: 0.85rem; color: var(--text-muted);">
                                <strong>For desktop apps:</strong> If you use Discord, OBS, or streaming software, use the <strong>Monitor</strong> page
                                to test with processing off and measure your raw levels against broadcast standards (-14 to -16 LUFS).
                            </p>
                            <p style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--border); font-size: 0.85rem; color: var(--text-muted);">
                                <strong>Technical note:</strong> We measure LUFS per <a href="https://www.itu.int/rec/R-REC-BS.1770" target="_blank" style="color: var(--accent);">ITU-R BS.1770-4</a> â€” the same standard used by Spotify, YouTube, and broadcast tools. This includes K-weighting filters (for perceptual accuracy), 400ms integration windows, and two-stage gating (to ignore silence). Algorithm structure informed by <a href="https://github.com/goepfert/loudness_adaption_demo" target="_blank" style="color: var(--accent);">goepfert/loudness_adaption_demo</a>.
                            </p>
                        </div>
                    </details>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Microphone</label>
                        <select id="quality-device-select" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.9rem; background: white;">
                            <option value="">Select microphone...</option>
                        </select>
                        <button id="btn-refresh-devices" style="margin-top: 0.5rem; padding: 0.4rem 0.8rem; font-size: 0.8rem; border: 1px solid var(--border); border-radius: 4px; background: var(--bg-muted); cursor: pointer;">
                            Refresh
                        </button>
                    </div>
                    
                    
                    <button id="btn-quality-start" class="btn btn-primary btn-large" style="width: 100%;">
                        Start Level Check
                    </button>
                </div>
                
                <!-- Step 1: Silence -->
                <div id="quality-step-silence" style="display: none;">
                    <div id="quality-device-info" style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 1rem;">
                        ðŸŽ¤ <span id="quality-device-name">â€”</span>
                        <span id="quality-device-settings"></span>
                    </div>
                    
                    <h3 style="margin-bottom: 0.5rem;">Step 1: Silence (5 seconds)</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Stay quiet. We're measuring background noise.
                    </p>
                    
                    <div class="visualizer-container" id="silence-visualizer" style="display: none; margin-bottom: 1rem;">
                        <div class="level-bar-container">
                            <div id="silence-level-bar" class="level-bar"></div>
                            <span id="silence-level-text" class="level-text">0%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                            <span>Silent</span>
                            <span id="silence-db-reading" style="font-weight: bold;">â€”</span>
                            <span>Loud</span>
                        </div>
                        <div style="text-align: center; margin-top: 0.75rem; font-size: 1.25rem; font-weight: bold;" id="silence-countdown"></div>
                    </div>
                    
                    <div id="silence-result" style="display: none; margin-bottom: 1rem; padding: 0.75rem; background: var(--bg-muted); border-radius: 8px;">
                        Noise Floor: <strong id="silence-final-reading">â€”</strong>
                    </div>
                    
                    <button id="btn-start-silence" class="btn btn-primary btn-large" style="width: 100%;">
                        Start Silence Recording
                    </button>
                    <button id="btn-next-to-voice" class="btn btn-primary btn-large" style="display: none; width: 100%;">
                        Continue to Voice Test â†’
                    </button>
                </div>
                
                <!-- Step 2: Voice -->
                <div id="quality-step-voice" style="display: none;">
                    <h3 style="margin-bottom: 0.5rem;">Step 2: Voice (10 seconds)</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                        Read this passage at your normal speaking volume:
                    </p>
                    
                    <blockquote style="background: #fffbf0; border-left: 4px solid #f0c040; padding: 1rem; margin: 0 0 1rem 0; font-style: italic; line-height: 1.6;">
                        "The rainbow appears when sunlight shines through falling rain. 
                        People look with awe at the brilliant colors stretching across the sky. 
                        Vibrant reds blend gently into warm oranges and yellows, 
                        while cool blues and deep purples fade softly at the edges.
                        Some say a pot of gold waits at the end, 
                        but no one has quite found it yet."
                    </blockquote>
                    
                    <div id="voice-pre-start" style="margin-bottom: 1rem;">
                        <button id="btn-start-voice" class="btn btn-primary btn-large" style="width: 100%;">
                            ðŸŽ¤ Start Recording (10 seconds)
                        </button>
                    </div>
                    
                    <div class="visualizer-container" id="voice-visualizer" style="display: none; margin-bottom: 1rem;">
                        <div class="level-bar-container" style="position: relative;">
                            <div style="position: absolute; left: 50%; right: 10%; height: 100%; background: rgba(30, 142, 62, 0.15); border-left: 2px dashed #1e8e3e; border-right: 2px dashed #1e8e3e; pointer-events: none;"></div>
                            <div id="voice-level-bar" class="level-bar"></div>
                            <span id="voice-level-text" class="level-text">0%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                            <span>Quiet</span>
                            <span id="voice-db-reading" style="font-weight: bold;">â€”</span>
                            <span>Loud</span>
                        </div>
                        <div style="text-align: center; margin-top: 0.75rem; font-size: 1.25rem; font-weight: bold;" id="voice-countdown"></div>
                    </div>
                    
                    <div id="voice-result" style="display: none; margin-bottom: 1rem; padding: 0.75rem; background: var(--bg-muted); border-radius: 8px;">
                        Loudness: <strong id="voice-lufs-final">â€”</strong> â€¢ Peak: <strong id="voice-peak-final">â€”</strong>
                    </div>
                    
                    <button id="btn-show-results" class="btn btn-primary btn-large" style="display: none; width: 100%;">
                        View Results â†’
                    </button>
                </div>
                
                <div id="quality-results" style="display: none;"></div>
            </div>
        </div>

        <!-- Screen 4: Audio Monitor -->
        <div id="screen-monitor" class="screen">
            <a href="#" class="back-link">â† Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ðŸ“¡</span>
                    <div>
                        <div class="card-title">Audio Monitor</div>
                        <div class="card-subtitle">Visualize your microphone input</div>
                    </div>
                </div>
                
                <div class="monitor-device-selector" style="margin-bottom: 1.5rem;">
                    <label for="monitor-device-select" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Microphone</label>
                    <select id="monitor-device-select" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 8px; font-size: 1rem; background: white;">
                        <option value="">Select microphone...</option>
                    </select>
                </div>
                
                <!-- Spectrogram Visualization -->
                <div class="monitor-viz-section">
                    <div class="monitor-viz-header">
                        <span class="monitor-viz-label">Spectrogram</span>
                    </div>
                    <div class="spectrogram-container" style="display: flex; gap: 0.5rem;">
                        <div style="display: flex; flex-direction: column; justify-content: space-between; font-size: 0.65rem; color: var(--text-muted); padding: 2px 0;">
                            <span>High</span>
                            <span>Low</span>
                        </div>
                        <div style="flex: 1;">
                            <canvas id="monitor-spectrogram-canvas" width="600" height="120" style="width: 100%; height: 120px; border-radius: 4px; background: #0a0a0a;"></canvas>
                            <div style="text-align: center; font-size: 0.65rem; color: var(--text-muted); margin-top: 0.25rem;">
                                â† time (scrolls left)
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Level Meter -->
                <div class="monitor-viz-section" style="margin-top: 1.5rem;">
                    <div class="monitor-viz-header">
                        <span class="monitor-viz-label">Level</span>
                    </div>
                    <div class="monitor-level-container">
                        <div class="level-bar-container">
                            <div id="monitor-level-bar" class="level-bar"></div>
                            <span id="monitor-level-text" class="level-text">-- dB</span>
                        </div>
                    </div>
                </div>
                
                <!-- Playback Feature -->
                <div class="monitor-viz-section" style="margin-top: 1.5rem;">
                    <div class="monitor-viz-header">
                        <span class="monitor-viz-label">Record & Playback</span>
                    </div>
                    
                    <div id="playback-container" style="margin-top: 0.5rem;">
                        <!-- Playback record prompt -->
                        <div id="playback-record-prompt" class="playback-section">
                            <p style="color: var(--text-secondary); margin-bottom: 0.75rem; font-size: 0.9rem;">
                                Hear what you sound like to others
                            </p>
                            <button id="btn-start-playback-record" class="btn btn-secondary" style="width: 100%;">
                                ðŸ”Š Record & Play Back (5 sec)
                            </button>
                            <p style="color: var(--text-muted); font-size: 0.75rem; margin-top: 0.5rem;">
                                ðŸ”’ Recording stays in your browser and is deleted when you leave
                            </p>
                        </div>
                        
                        <!-- Countdown state -->
                        <div id="playback-countdown" class="playback-section" style="display: none; text-align: center;">
                            <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">Get ready to speak...</p>
                            <div id="countdown-number" class="countdown-display">3</div>
                        </div>
                        
                        <!-- Recording state -->
                        <div id="playback-recording" class="playback-section" style="display: none; text-align: center;">
                            <div class="recording-indicator">
                                <span class="recording-dot"></span>
                                <span>Recording...</span>
                            </div>
                            <div id="recording-timer" style="font-size: 1.5rem; font-weight: bold; margin: 0.5rem 0;">5</div>
                            <p style="color: var(--text-secondary); font-size: 0.85rem;">Speak now!</p>
                        </div>
                        
                        <!-- Playback controls - visible after recording completes (during ready AND playing states) -->
                        <div id="playback-controls" class="playback-section" style="display: none;">
                            <!-- Playback mode toggle - processed vs raw -->
                            <div id="playback-mode-selector" class="playback-mode-toggle">
                                <div class="playback-mode-info">
                                    <span class="playback-mode-icon" id="playback-mode-icon">ðŸ”Š</span>
                                    <div class="playback-mode-text">
                                        <strong id="playback-mode-label">Audio Processing</strong>
                                        <div id="playback-mode-description" class="playback-mode-desc">
                                            What browser apps hear
                                        </div>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="playback-processing-toggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            
                            <!-- Error state when one stream failed -->
                            <div id="playback-mode-error" class="playback-mode-error" style="display: none;">
                                <span class="error-icon">âš ï¸</span>
                                <span id="playback-mode-error-text">Raw recording unavailable</span>
                            </div>
                            
                            <div id="playback-warning" class="status-card warning" style="display: none; margin-bottom: 1rem;">
                                <span class="status-icon">ðŸ”‡</span>
                                <div class="status-text">
                                    <div class="status-title">We didn't hear much</div>
                                    <div class="status-detail">
                                        Your mic may be too quiet. 
                                        <a href="#" id="link-playback-level-check" style="color: var(--accent);">Run a Level Check</a> to diagnose.
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Ready state buttons -->
                            <div id="playback-ready-buttons" class="btn-group" style="justify-content: center;">
                                <button id="btn-play-recording" class="btn btn-primary">
                                    â–¶ï¸ Play Recording
                                </button>
                                <button id="btn-record-again" class="btn btn-secondary">
                                    ðŸ”„ Record Again
                                </button>
                            </div>
                            
                            <!-- Playing state buttons -->
                            <div id="playback-playing-buttons" style="display: none; text-align: center;">
                                <div style="font-size: 1.1rem; margin-bottom: 0.5rem; color: var(--accent);">ðŸ”Š Playing...</div>
                                <button id="btn-stop-playback" class="btn btn-secondary btn-small">
                                    â¹ï¸ Stop
                                </button>
                            </div>
                        </div>
                        
                        <!-- Hidden audio element -->
                        <audio id="playback-audio" style="display: none;"></audio>
                    </div>
                </div>
                
                <!-- Coming Soon Placeholder -->
                <div class="monitor-coming-soon" style="margin-top: 1.5rem; padding: 1rem; background: var(--bg-muted); border-radius: 8px; text-align: center;">
                    <span style="font-size: 1.25rem;">ðŸ”®</span>
                    <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">
                        <strong>Coming soon:</strong> Waveform â€¢ Frequency spectrum â€¢ Stereo field
                    </div>
                </div>
            </div>
        </div>

        <!-- Screen 5: Studio Monitor (DAW-style advanced monitoring) -->
        <div id="screen-studio" class="screen">
            <a href="#" class="back-link">â† Back</a>
            
            <div class="studio-layout">
                <!-- Transport Bar -->
                <div class="studio-transport">
                    <div class="studio-transport-device">
                        <select id="studio-device-select">
                            <option value="">Select microphone...</option>
                        </select>
                    </div>
                    
                    <div class="studio-transport-controls">
                        <button id="studio-btn-record" class="transport-btn" title="Record" disabled>
                            âº
                        </button>
                        <button id="studio-btn-stop" class="transport-btn" title="Stop" disabled>
                            â¹
                        </button>
                        <button id="studio-btn-play" class="transport-btn" title="Play" disabled>
                            â–¶
                        </button>
                        <div class="transport-time" id="studio-time">00:00</div>
                        <div class="transport-status" id="studio-status">Ready</div>
                    </div>
                </div>
                
                <!-- Permission Prompt (shown until mic access granted) -->
                <div id="studio-permission-prompt" class="studio-viz-main studio-permission-prompt">
                    <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ðŸŽšï¸</div>
                    <p>Grant microphone access to start monitoring</p>
                    <button id="studio-btn-grant" class="btn btn-primary">
                        Enable Microphone
                    </button>
                </div>
                
                <!-- Main Visualization (shown after permission) -->
                <div id="studio-viz-container" class="studio-viz-main" style="display: none;">
                    <!-- Spectrogram -->
                    <div class="studio-spectrogram">
                        <div class="studio-section-label">
                            Spectrogram
                            <span class="studio-help-icon" tabindex="0">â“˜
                                <div class="studio-help-tooltip">
                                    <strong>What it shows</strong>
                                    Frequency content over time. Low frequencies at the bottom, high at top. Brighter colors = louder.
                                    <ul>
                                        <li><strong>Noise patterns:</strong> Constant horizontal lines indicate room noise or hum</li>
                                        <li><strong>Sibilance:</strong> Bright flashes in the 5-8kHz region on "S" sounds</li>
                                        <li><strong>Plosives:</strong> Low-frequency bursts on P/B sounds</li>
                                    </ul>
                                </div>
                            </span>
                        </div>
                        <div class="studio-spectrogram-container">
                            <div class="studio-viz-axis studio-spectrogram-axis">
                                <span>20k</span>
                                <span>8k</span>
                                <span>1k</span>
                                <span>100</span>
                            </div>
                            <div class="studio-spectrogram-canvas-wrap">
                                <!-- Canvas: 700Ã—180px prevents scaling artifacts. CSS controls display size. -->
                                <canvas id="studio-spectrogram" class="studio-spectrogram-canvas" width="700" height="180"></canvas>
                                <div class="studio-spectrogram-time">â† time</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Frequency Spectrum (Bar Graph) -->
                    <div class="studio-spectrum">
                        <div class="studio-section-label">
                            Spectrum
                            <span class="studio-help-icon" tabindex="0">â“˜
                                <div class="studio-help-tooltip">
                                    <strong>What it shows</strong>
                                    Real-time frequency content as vertical bars. Bar color indicates intensity: <strong style="color: #4caf50;">green</strong> (quiet) â†’ <strong style="color: #ffeb3b;">yellow</strong> (medium) â†’ <strong style="color: #f44336;">red</strong> (loud).
                                    <ul>
                                        <li><strong>Below 100Hz spike:</strong> Plosive, rumble, or handling noise</li>
                                        <li><strong>100-250Hz heavy:</strong> Too close to mic (proximity effect)</li>
                                        <li><strong>5-8kHz spike:</strong> Sibilance problem â€” harsh "S" sounds</li>
                                        <li><strong>Constant 50/60Hz bar:</strong> Electrical hum</li>
                                    </ul>
                                </div>
                            </span>
                        </div>
                        <div class="studio-spectrum-container">
                            <!-- Empty axis placeholder for alignment with other widgets -->
                            <div class="studio-viz-axis studio-spectrum-axis"></div>
                            <div class="studio-spectrum-main">
                                <div class="studio-spectrum-canvas-wrap">
                                    <!-- Canvas: 700Ã—80px matches other widget widths -->
                                    <canvas id="studio-spectrum" class="studio-spectrum-canvas" width="700" height="80"></canvas>
                                </div>
                                <div class="studio-spectrum-labels">
                                    <span>80</span>
                                    <span>200</span>
                                    <span>500</span>
                                    <span>1k</span>
                                    <span>2k</span>
                                    <span>5k</span>
                                    <span>10k</span>
                                    <span>16k</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Waveform + Level Meters Row -->
                    <div class="studio-waveform-row">
                        <!-- Oscilloscope (Waveform) -->
                        <div class="studio-oscilloscope">
                            <div class="studio-section-label">
                                Waveform
                                <span class="studio-help-icon" tabindex="0">â“˜
                                    <div class="studio-help-tooltip">
                                        <strong>What it shows</strong>
                                        The actual audio waveform in real-time (~40ms window). Classic oscilloscope view.
                                        <ul>
                                            <li><strong>Flat-topped peaks:</strong> Clipping â€” audio is distorting</li>
                                            <li><strong>One-sided spikes:</strong> Plosives (P/B sounds hitting the mic)</li>
                                            <li><strong>Sharp vs soft attacks:</strong> Shows voice delivery consistency</li>
                                            <li><strong>Barely visible wave:</strong> Speak up or move closer</li>
                                        </ul>
                                    </div>
                                </span>
                            </div>
                            <div class="studio-oscilloscope-container">
                                <div class="studio-viz-axis studio-oscilloscope-axis">
                                    <span>+1</span>
                                    <span>0</span>
                                    <span>âˆ’1</span>
                                </div>
                                <div class="studio-oscilloscope-canvas-wrap">
                                    <!-- Canvas: 700Ã—100px matches spectrogram width, shorter height for stacking -->
                                    <canvas id="studio-oscilloscope" class="studio-oscilloscope-canvas" width="700" height="100"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Vertical Level Meters -->
                        <div class="studio-meters-vertical">
                            <div id="studio-levels-label" class="studio-section-label">
                                Level
                                <span class="studio-help-icon" tabindex="0">â“˜
                                    <div class="studio-help-tooltip">
                                        <strong>What it shows</strong>
                                        Audio level in decibels (dB). The thin line shows peak hold â€” the loudest moment in the last 2 seconds.
                                        <ul>
                                            <li><strong>Green zone (-40 to -12dB):</strong> Good recording level</li>
                                            <li><strong>Yellow zone (-12 to -6dB):</strong> Getting hot â€” watch for peaks</li>
                                            <li><strong>Red zone (above -6dB):</strong> Risk of clipping</li>
                                            <li><strong>Aim for peaks around -12dB</strong> with headroom to spare</li>
                                        </ul>
                                    </div>
                                </span>
                            </div>
                            <div class="studio-vmeter-container">
                                <div id="studio-meter-col-l" class="studio-vmeter-col">
                                    <div class="studio-vmeter-bar">
                                        <div id="studio-meter-l-fill" class="studio-vmeter-fill"></div>
                                        <div id="studio-meter-l-peak" class="studio-vmeter-peak" style="bottom: 0;"></div>
                                    </div>
                                    <span id="studio-meter-label-l" class="studio-vmeter-label">L</span>
                                </div>
                                <div id="studio-meter-col-r" class="studio-vmeter-col">
                                    <div class="studio-vmeter-bar">
                                        <div id="studio-meter-r-fill" class="studio-vmeter-fill"></div>
                                        <div id="studio-meter-r-peak" class="studio-vmeter-peak" style="bottom: 0;"></div>
                                    </div>
                                    <span class="studio-vmeter-label">R</span>
                                </div>
                            </div>
                            <div id="studio-meter-db" class="studio-vmeter-db">-âˆž</div>
                        </div>
                    </div>
                    
                    <!-- Readouts -->
                    <div class="studio-readouts">
                        <div class="studio-readout">
                            <div class="studio-readout-label">
                                Peak (dBFS)
                                <span class="studio-help-icon" tabindex="0">â“˜
                                    <div class="studio-help-tooltip">
                                        <strong>What it shows</strong>
                                        The highest signal level detected, in decibels relative to Full Scale (dBFS). 0 dBFS = maximum digital level.
                                        <ul>
                                            <li><strong>-12 to -6 dBFS:</strong> Good peak range â€” loud but safe</li>
                                            <li><strong>Above -3 dBFS:</strong> Risk of clipping on loud moments</li>
                                            <li><strong>0 dBFS:</strong> Clipping â€” audio is distorting</li>
                                            <li><strong>Below -20 dBFS:</strong> Recording too quiet</li>
                                        </ul>
                                        <em style="font-size: 0.8rem; color: var(--text-muted);">Note: This is sample peak, not True Peak (which requires 4Ã— oversampling).</em>
                                    </div>
                                </span>
                            </div>
                            <div id="studio-peak-value" class="studio-readout-value">-âˆž</div>
                        </div>
                        <div class="studio-readout">
                            <div class="studio-readout-label">
                                LUFS (short-term)
                                <span class="studio-help-icon" tabindex="0">â“˜
                                    <div class="studio-help-tooltip">
                                        <strong>What it shows</strong>
                                        Perceived loudness over 3 seconds, in Loudness Units relative to Full Scale (LUFS). Unlike dB, LUFS uses K-weighting to match how humans hear.
                                        <ul>
                                            <li><strong>-14 LUFS:</strong> Spotify, YouTube target</li>
                                            <li><strong>-16 LUFS:</strong> Podcast standard</li>
                                            <li><strong>-23 LUFS:</strong> Broadcast (EBU R128)</li>
                                            <li><strong>-24 LUFS:</strong> Broadcast (ATSC A/85)</li>
                                        </ul>
                                        <em style="font-size: 0.8rem; color: var(--text-muted);">1 LUFS â‰ˆ 1 dB for comparison purposes.</em>
                                    </div>
                                </span>
                            </div>
                            <div id="studio-lufs-value" class="studio-readout-value">-âˆž</div>
                        </div>
                        <div id="studio-balance-container" class="studio-readout">
                            <div class="studio-readout-label">
                                Balance
                                <span class="studio-help-icon" tabindex="0">â“˜
                                    <div class="studio-help-tooltip">
                                        <strong>What it shows</strong>
                                        Left/right channel balance for stereo microphones. Shows which channel is louder.
                                        <ul>
                                            <li><strong>C (Center):</strong> Both channels equal â€” ideal</li>
                                            <li><strong>L or R:</strong> One channel is louder</li>
                                            <li><strong>Mono mic:</strong> This indicator is hidden</li>
                                        </ul>
                                        <em style="font-size: 0.8rem; color: var(--text-muted);">Imbalance may indicate a dead channel or stereo misconfiguration.</em>
                                    </div>
                                </span>
                            </div>
                            <div id="studio-balance-value" class="studio-readout-value">â€”</div>
                        </div>
                    </div>
                </div>
                
                <!-- Recording Strip (shown after permission) -->
                <div id="studio-recording-container" class="studio-recording" style="display: none;">
                    <div class="studio-section-label">Recording</div>
                    <div class="studio-recording-strip">
                        <div class="studio-recording-info">
                            <span id="studio-rec-dot" class="studio-recording-dot"></span>
                            <span id="studio-rec-time" class="studio-recording-time">00:00</span>
                        </div>
                        
                        <div class="studio-recording-waveform">
                            <canvas id="studio-waveform-canvas" width="600" height="40"></canvas>
                            <div id="studio-waveform-empty" class="studio-recording-empty">
                                Press âº to record
                            </div>
                        </div>
                        
                        <div class="studio-recording-actions">
                            <button id="studio-rec-play" class="studio-recording-btn" disabled>â–¶ Play</button>
                            <button id="studio-rec-delete" class="studio-recording-btn" disabled>ðŸ—‘</button>
                        </div>
                    </div>
                    
                    <!-- Processing toggle -->
                    <div class="studio-processing-toggle">
                        <span class="studio-processing-label">Audio Processing (AGC, noise suppression):</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="studio-processing-toggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <span id="studio-processing-status" style="font-size: 0.8rem; color: var(--text-muted);">On</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Screen 6: Privacy Check -->
        <div id="screen-privacy" class="screen">
            <a href="#" class="back-link">â† Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ðŸ”</span>
                    <div>
                        <div class="card-title">Browser Microphone Privacy Check</div>
                        <div class="card-subtitle">Understanding what your browser exposes</div>
                    </div>
                </div>
                
                <div id="privacy-content">
                    <div id="privacy-permission-status"></div>
                    
                    <button id="btn-privacy-check" class="btn btn-secondary" style="display: none;">
                        ðŸ”„ Re-check
                    </button>
                    
                    <div id="privacy-results" style="display: none;">
                        <!-- Populated by JS -->
                    </div>
                </div>
                
                <details style="margin-top: 1.5rem;">
                    <summary style="cursor: pointer; font-weight: 500;">ðŸ”„ How to reset microphone permissions</summary>
                    <div id="reset-instructions" style="margin-top: 0.75rem; padding: 1rem; background: var(--bg-muted); border-radius: 8px;">
                        <!-- Populated based on browser -->
                    </div>
                </details>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ðŸ’¡</span>
                    <div>
                        <div class="card-title">Good to know</div>
                    </div>
                </div>
                
                <ul style="margin: 0; padding-left: 1.25rem; color: var(--text-secondary); line-height: 1.8;">
                    <li><strong>Permission â‰  listening.</strong> Granting permission lets a site <em>request</em> your mic â€” it doesn't mean it's recording.</li>
                    <li><strong>Browsers show when mic is active.</strong> Look for a red dot or microphone icon in your tab/address bar.</li>
                    <li><strong>Permissions are per-site.</strong> Each website has its own permission setting.</li>
                    <li><strong>Closing the tab stops access.</strong> No website can listen when you're not on it.</li>
                </ul>
            </div>
        </div>

        <footer>
            <p>Mic Check â€” A free, open-source tool</p>
            <p>No data is collected. Everything runs in your browser.</p>
            <p style="margin-top: 0.5rem;">
                <a href="https://github.com/mread/mic-check" target="_blank" rel="noopener noreferrer">GitHub</a>
                Â· 
                <a href="https://github.com/mread/mic-check/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">MIT License</a>
            </p>
        </footer>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
