<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mic Check ‚Äî Browser Microphone Diagnostic Tool</title>
    <!-- 
        Mic Check - Browser Microphone Diagnostic Tool
        Copyright (c) 2026 Matt Read
        Licensed under the MIT License
        https://github.com/mread/mic-check
    -->
    <meta name="description" content="Free tool to test your microphone, check browser permissions, and diagnose why your mic isn't working. No data collected, runs entirely in your browser.">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Mic Check ‚Äî Is Your Microphone Working?">
    <meta property="og:description" content="Free browser-based microphone diagnostic tool. Test your mic, check permissions, troubleshoot issues.">
    <meta property="og:type" content="website">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé§</text></svg>">
    
    <style>
        /* System font stacks - no external requests for privacy */
        
        :root {
            --bg: #f8f9fa;
            --bg-card: #ffffff;
            --bg-muted: #f1f3f4;
            --bg-elevated: #ffffff;
            --text: #202124;
            --text-secondary: #5f6368;
            --text-muted: #9aa0a6;
            --border: #dadce0;
            --accent: #1a73e8;
            --accent-light: #e8f0fe;
            --problem: #d93025;
            --problem-light: #fce8e6;
            --ok: #1e8e3e;
            --success: #1e8e3e;
            --success-light: #e6f4ea;
            --warning: #f9ab00;
            --warning-light: #fef7e0;
            --shadow: 0 1px 2px rgba(0,0,0,0.1);
            --shadow-lg: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }
        
        /* Header */
        header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .logo {
            font-size: 4rem;
            margin-bottom: 0.5rem;
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .tagline {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .privacy-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--bg-muted);
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 1rem;
        }
        
        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .card-icon {
            font-size: 2rem;
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .card-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Homepage Layout */
        .home-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            align-items: start;
        }
        
        .home-primary {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .home-secondary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }
        
        @media (max-width: 768px) {
            .home-grid {
                grid-template-columns: 1fr;
            }
            .home-secondary {
                grid-template-columns: 1fr;
            }
        }
        
        /* Journey Cards */
        .journey-card {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }
        
        .journey-card:hover {
            border-color: var(--accent);
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        .journey-card.featured {
            border-color: var(--accent);
            background: var(--accent-light);
        }
        
        .journey-icon {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }
        
        .journey-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .journey-desc {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }
        
        /* Compact primary action */
        .primary-action {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
        }
        
        /* Removed - Level Check now matches Quick Test styling */
        
        /* Buttons */
        .btn {
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: var(--accent);
            color: white;
        }
        
        .btn-primary:hover {
            filter: brightness(1.1);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text);
            border: 1px solid var(--border);
        }
        
        .btn-secondary:hover {
            border-color: var(--accent);
        }
        
        .btn-large {
            width: 100%;
            padding: 1.25rem 2rem;
            font-size: 1.1rem;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .btn-group {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }
        
        /* Status Indicators */
        .status-card {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem 1.25rem;
            border-radius: 12px;
            margin: 1rem 0;
            background: var(--bg-muted);
        }
        
        .status-card.success {
            background: #e6f4ea;
        }
        
        .status-card.problem {
            background: var(--problem-light);
        }
        
        /* Legacy classes for compatibility */
        .status-card.warning { background: var(--problem-light); }
        .status-card.error { background: var(--problem-light); }
        .status-card.info { background: var(--accent-light); }
        
        .status-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .status-text {
            flex: 1;
        }
        
        .status-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .status-detail {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* Visualizer */
        .visualizer-container {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .visualizer-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .level-bar-container {
            height: 32px;
            /* Fixed color zones like a real VU meter - dark/inactive colors */
            background: linear-gradient(90deg, 
                #1a3d1a 0%,      /* dark green zone */
                #1a3d1a 60%,     /* green up to -12dB equivalent */
                #3d3d1a 60%,     /* dark yellow zone */
                #3d3d1a 85%,     /* yellow up to -6dB equivalent */
                #3d1a1a 85%,     /* dark red zone */
                #3d1a1a 100%     /* red at peak */
            );
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            border: 1px solid #333;
        }
        
        .level-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%; /* Always full width */
            /* Bright gradient - same zones as container but bright colors */
            background: linear-gradient(90deg, 
                #22c55e 0%,      /* bright green */
                #22c55e 60%,     /* green zone */
                #eab308 60%,     /* bright yellow */
                #eab308 85%,     /* yellow zone */
                #ef4444 85%,     /* bright red */
                #ef4444 100%     /* red zone */
            );
            border-radius: 3px;
            transition: clip-path 0.03s ease;
            /* Use clip-path to reveal only the active portion */
            clip-path: inset(0 100% 0 0); /* Start fully clipped */
        }
        
        .level-text {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
        }
        
        /* Device List */
        .device-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: var(--bg-elevated);
            border-radius: 12px;
            margin: 0.5rem 0;
        }
        
        .device-item.active {
            background: var(--success-light);
            border: 1px solid var(--success);
        }
        
        .device-name {
            font-weight: 500;
        }
        
        .device-id {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-family: ui-monospace, 'SF Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
        }
        
        /* Info Sections */
        .info-box {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            margin: 1rem 0;
        }
        
        .info-box h4 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .info-box p, .info-box ul {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .info-box ul {
            margin-left: 1.25rem;
        }
        
        .info-box li {
            margin: 0.25rem 0;
        }
        
        /* Back Link */
        .back-link {
            display: inline-block;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            padding: 0.25rem 0;
        }
        
        .back-link:hover {
            color: var(--accent);
        }
        
        /* Progress Steps (for multi-step flows only) */
        .steps {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .step {
            flex: 1;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
        }
        
        .step.active {
            background: var(--accent);
        }
        
        .step.complete {
            background: var(--success);
        }
        
        /* Privacy Section */
        .privacy-section {
            background: var(--bg-muted);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            margin: 1.5rem 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        .privacy-section p {
            margin: 0;
            line-height: 1.7;
        }
        
        /* Collapsible */
        .collapsible {
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .collapsible-header {
            padding: 1rem;
            background: var(--bg-elevated);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 500;
        }
        
        .collapsible-header:hover {
            background: var(--border);
        }
        
        .collapsible-content {
            padding: 1rem;
            display: none;
        }
        
        .collapsible.open .collapsible-content {
            display: block;
        }
        
        .collapsible-arrow {
            transition: transform 0.2s;
        }
        
        .collapsible.open .collapsible-arrow {
            transform: rotate(180deg);
        }
        
        /* Screens */
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Table */
        .info-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        .info-table th, .info-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .info-table th {
            font-weight: 600;
            background: var(--bg-elevated);
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
            font-size: 0.85rem;
        }
        
        footer a {
            color: var(--accent);
            text-decoration: none;
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.75rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
            flex-shrink: 0;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.3s;
            border-radius: 28px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .toggle-switch input:checked + .toggle-slider {
            background-color: var(--accent);
        }
        
        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }
        
        /* AGC Status Bar */
        .agc-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        .agc-status.agc-on {
            background: #e8f5e9;
            border: 1px solid #81c784;
            color: #2e7d32;
        }
        .agc-status.agc-off {
            background: #fff3e0;
            border: 1px solid #ffb74d;
            color: #e65100;
        }
        .agc-status .detail {
            font-weight: normal;
            color: inherit;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">üé§</div>
            <h1>Mic Check</h1>
            <p class="tagline">Browser Microphone Diagnostic Tool</p>
            <div class="privacy-badge">
                üîí 100% Private ‚Äî No data leaves your browser
            </div>
        </header>

        <!-- Screen 1: Journey Selection -->
        <div id="screen-select" class="screen active">
            <div class="home-grid">
                <!-- Left: Primary Actions -->
                <div class="home-primary">
                    <!-- Quick Test -->
                    <div class="primary-action">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üé§</div>
                        <h2 style="font-size: 1.25rem; margin-bottom: 0.5rem;">Quick Microphone Test</h2>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                            Check if your mic is working
                        </p>
                        <button id="btn-home-test" class="btn btn-primary" style="width: 100%;">
                            Start Test
                        </button>
                    </div>
                    
                    <!-- Level Check -->
                    <div class="primary-action">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üìä</div>
                        <h2 style="font-size: 1.25rem; margin-bottom: 0.5rem;">Level Check</h2>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                            Are you loud enough to be heard?
                        </p>
                        <button id="btn-home-quality" class="btn btn-primary" style="width: 100%;">
                            Check Levels
                        </button>
                    </div>
                </div>
                
                <!-- Right: Secondary Options -->
                <div class="home-secondary">
                    <div class="journey-card" data-journey="troubleshoot">
                        <div class="journey-icon">üîß</div>
                        <div class="journey-title">Mic not working?</div>
                        <div class="journey-desc">Troubleshooting guide</div>
                    </div>
                    
                    <div class="journey-card" data-journey="privacy">
                        <div class="journey-icon">üîê</div>
                        <div class="journey-title">Privacy check</div>
                        <div class="journey-desc">Is my browser listening?</div>
                    </div>
                    
                    <div class="journey-card" data-journey="app-debug">
                        <div class="journey-icon">üåê</div>
                        <div class="journey-title">Site-specific issues</div>
                        <div class="journey-desc">Works here, not there?</div>
                    </div>
                    
                    <div class="journey-card" style="background: var(--bg-muted); border-style: dashed; opacity: 0.7; cursor: default;">
                        <div class="journey-icon">üéöÔ∏è</div>
                        <div class="journey-title" style="color: var(--text-muted);">Gain Staging</div>
                        <div class="journey-desc">Coming soon</div>
                    </div>
                    
                    <div class="journey-card" style="background: var(--bg-muted); border-style: dashed; opacity: 0.7; cursor: default;">
                        <div class="journey-icon">ü§ù</div>
                        <div class="journey-title" style="color: var(--text-muted);">Help a Friend</div>
                        <div class="journey-desc">Coming soon</div>
                    </div>
                </div>
            </div>
            
            <div class="privacy-section" style="margin-top: 1rem;">
                <p style="font-size: 0.8rem;">
                    üîí <strong>100% Private:</strong> No audio recorded. No data sent. No cookies.
                </p>
            </div>
        </div>

        <!-- Screen 2: Quick Test -->
        <div id="screen-quick-test" class="screen">
            <a href="#" class="back-link" onclick="window.MicCheck.showScreen('screen-select'); return false;">‚Üê Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üé§</span>
                    <div>
                        <div class="card-title">Quick Microphone Test</div>
                        <div class="card-subtitle">Click the button to test your microphone</div>
                    </div>
                </div>
                
                <!-- AGC status indicator for quick test -->
                <div id="quick-agc-status" class="agc-status agc-on" style="display: none; margin-bottom: 1rem;">
                    <span id="quick-agc-icon">üîä</span>
                    <span id="quick-agc-text">AGC: On</span>
                    <span class="detail">‚Äî automatic level adjustment (browser default)</span>
                </div>
                
                <div id="quick-test-status"></div>
                
                <button id="btn-quick-test" class="btn btn-primary btn-large">
                    üé§ Start Microphone Test
                </button>
                
                <div id="quick-visualizer" style="display: none;">
                    <p style="margin-bottom: 0.75rem; color: var(--text-secondary);">
                        Speak or make a sound ‚Äî watch the spectrogram and level meter:
                    </p>
                    
                    <!-- Spectrogram Canvas -->
                    <div class="spectrogram-container" style="margin-bottom: 1rem; display: flex; gap: 0.5rem;">
                        <div style="display: flex; flex-direction: column; justify-content: space-between; font-size: 0.65rem; color: var(--text-muted); padding: 2px 0;">
                            <span>High</span>
                            <span>Low</span>
                        </div>
                        <div style="flex: 1;">
                            <canvas id="spectrogram-canvas" width="500" height="100" style="width: 100%; height: 100px; border-radius: 4px; background: #0a0a0a;"></canvas>
                            <div style="text-align: center; font-size: 0.65rem; color: var(--text-muted); margin-top: 0.25rem;">
                                ‚Üê time (scrolls left)
                            </div>
                        </div>
                    </div>
                    
                    <!-- Level Meter -->
                    <div class="visualizer-container">
                        <div class="level-bar-container">
                            <div id="quick-level-bar" class="level-bar"></div>
                            <span id="quick-level-text" class="level-text">0%</span>
                        </div>
                    </div>
                    
                    <div id="quick-result" class="status-card success" style="display: none; margin-top: 1rem;">
                        <span class="status-icon">‚úÖ</span>
                        <div class="status-text">
                            <div class="status-title">Your microphone is working!</div>
                        </div>
                    </div>
                    
                    <button id="btn-quick-stop" class="btn btn-secondary" style="margin-top: 1rem;">
                        ‚èπÔ∏è Stop Test
                    </button>
                </div>
            </div>
        </div>

        <!-- Screen 3: Troubleshoot -->
        <div id="screen-troubleshoot" class="screen">
            <a href="#" class="back-link" onclick="window.MicCheck.showScreen('screen-select'); return false;">‚Üê Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üîß</span>
                    <div>
                        <div class="card-title">Microphone Troubleshooter</div>
                        <div class="card-subtitle" id="ts-subtitle">Let's figure out what's going on</div>
                    </div>
                </div>
                
                <div id="troubleshoot-content">
                    <!-- Step 1: Check browser support -->
                    <div id="ts-check-support">
                        <p style="margin-bottom: 1rem;">First, let's check if your browser supports microphone access...</p>
                        <button id="btn-ts-check-support" class="btn btn-primary btn-large">
                            üîç Check Browser Support
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Screen 4: Privacy Check -->
        <div id="screen-privacy" class="screen">
            <a href="#" class="back-link" onclick="window.MicCheck.showScreen('screen-select'); return false;">‚Üê Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üîê</span>
                    <div>
                        <div class="card-title">Browser Microphone Privacy Check</div>
                        <div class="card-subtitle">Understanding what your browser exposes</div>
                    </div>
                </div>
                
                <div id="privacy-content">
                    <div id="privacy-permission-status"></div>
                    
                    <button id="btn-privacy-check" class="btn btn-secondary" style="display: none;">
                        üîÑ Re-check
                    </button>
                    
                    <div id="privacy-results" style="display: none;">
                        <!-- Populated by JS -->
                    </div>
                </div>
                
                <details style="margin-top: 1.5rem;">
                    <summary style="cursor: pointer; font-weight: 500;">üîÑ How to reset microphone permissions</summary>
                    <div id="reset-instructions" style="margin-top: 0.75rem; padding: 1rem; background: var(--bg-muted); border-radius: 8px;">
                        <!-- Populated based on browser -->
                    </div>
                </details>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üí°</span>
                    <div>
                        <div class="card-title">Good to know</div>
                    </div>
                </div>
                
                <ul style="margin: 0; padding-left: 1.25rem; color: var(--text-secondary); line-height: 1.8;">
                    <li><strong>Permission ‚â† listening.</strong> Granting permission lets a site <em>request</em> your mic ‚Äî it doesn't mean it's recording.</li>
                    <li><strong>Browsers show when mic is active.</strong> Look for a red dot or microphone icon in your tab/address bar.</li>
                    <li><strong>Permissions are per-site.</strong> Each website has its own permission setting.</li>
                    <li><strong>Closing the tab stops access.</strong> No website can listen when you're not on it.</li>
                </ul>
            </div>
        </div>

        <!-- Screen 5: App-specific Debug -->
        <div id="screen-app-debug" class="screen">
            <a href="#" class="back-link" onclick="window.MicCheck.showScreen('screen-select'); return false;">‚Üê Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üåê</span>
                    <div>
                        <div class="card-title">Website-Specific Microphone Issues</div>
                        <div class="card-subtitle">Your mic works here but not on another site? Let's diagnose.</div>
                    </div>
                </div>
                
                <div id="app-debug-content">
                    <p style="margin-bottom: 1.5rem;">We'll run a full diagnostic to help you figure out why a specific website can't access your microphone.</p>
                    
                    <button id="btn-app-debug-start" class="btn btn-primary btn-large">
                        üî¨ Run Full Diagnostic
                    </button>
                    
                    <div id="app-debug-results" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- Screen 6: Level Check -->
        <div id="screen-quality" class="screen">
            <a href="#" class="back-link" onclick="window.MicCheck.showScreen('screen-select'); return false;">‚Üê Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üìä</span>
                    <div>
                        <div class="card-title">Microphone Level Check</div>
                        <div class="card-subtitle">Are you loud enough to be heard clearly?</div>
                    </div>
                </div>
                
                <!-- Persistent AGC status indicator -->
                <div id="agc-status-bar" class="agc-status agc-off" style="display: none; margin-bottom: 1rem;">
                    <span id="agc-status-icon">üîá</span>
                    <span id="agc-status-text">AGC: Off</span>
                    <span id="agc-status-detail" class="detail"></span>
                </div>
                
                <div id="quality-intro">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        We'll measure your background noise, then your voice, and compare to streaming standards.
                    </p>
                    
                    <details style="margin-bottom: 1.5rem; font-size: 0.9rem;">
                        <summary style="cursor: pointer; color: var(--accent); font-weight: 500;">‚ÑπÔ∏è About this test (LUFS, standards)</summary>
                        <div style="margin-top: 0.75rem; padding: 1rem; background: var(--bg-muted); border-radius: 8px;">
                            <p style="margin-bottom: 0.75rem;"><strong>LUFS (Loudness Units Full Scale)</strong> measures perceived loudness ‚Äî how loud audio <em>sounds</em> to human ears.</p>
                            <p style="margin-bottom: 0.75rem;"><strong>Industry targets:</strong></p>
                            <ul style="margin: 0 0 0.75rem 1.25rem; color: var(--text-secondary);">
                                <li><strong>-14 LUFS</strong> ‚Äî Spotify, YouTube, Apple Music</li>
                                <li><strong>-16 LUFS</strong> ‚Äî Podcasts (Apple recommendation)</li>
                                <li><strong>-23 LUFS</strong> ‚Äî Broadcast TV (EBU R128)</li>
                            </ul>
                            <p style="margin-bottom: 0.5rem;"><strong>We measure:</strong></p>
                            <ul style="margin: 0 0 0 1.25rem; color: var(--text-secondary);">
                                <li><strong>Noise floor</strong> ‚Äî background noise when silent (target: below -40 dBFS)</li>
                                <li><strong>Voice level</strong> ‚Äî your speaking volume (target: -16 to -14 LUFS)</li>
                                <li><strong>Peak level</strong> ‚Äî loudest moment (target: -6 to -1 dBFS)</li>
                                <li><strong>Signal-to-noise</strong> ‚Äî voice vs noise ratio (target: >20 dB)</li>
                            </ul>
                        </div>
                    </details>
                    
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Microphone</label>
                        <select id="quality-device-select" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.9rem; background: white;">
                            <option value="">Select microphone...</option>
                        </select>
                        <button id="btn-refresh-devices" style="margin-top: 0.5rem; padding: 0.4rem 0.8rem; font-size: 0.8rem; border: 1px solid var(--border); border-radius: 4px; background: var(--bg-muted); cursor: pointer;">
                            Refresh
                        </button>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding: 1rem; background: var(--bg-muted); border-radius: 8px;">
                        <div>
                            <strong>Auto Gain Control</strong>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">
                                On (recommended) = what apps hear
                            </div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="agc-toggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <button id="btn-quality-start" class="btn btn-primary btn-large" style="width: 100%;">
                        Start Level Check
                    </button>
                </div>
                
                <!-- Step 1: Silence -->
                <div id="quality-step-silence" style="display: none;">
                    <div id="quality-device-info" style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 1rem;">
                        üé§ <span id="quality-device-name">‚Äî</span>
                        <span id="quality-device-settings"></span>
                    </div>
                    
                    <h3 style="margin-bottom: 0.5rem;">Step 1: Silence (5 seconds)</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Stay quiet. We're measuring background noise.
                    </p>
                    
                    <div class="visualizer-container" id="silence-visualizer" style="display: none; margin-bottom: 1rem;">
                        <div class="level-bar-container">
                            <div id="silence-level-bar" class="level-bar"></div>
                            <span id="silence-level-text" class="level-text">0%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                            <span>Silent</span>
                            <span id="silence-db-reading" style="font-weight: bold;">‚Äî</span>
                            <span>Loud</span>
                        </div>
                        <div style="text-align: center; margin-top: 0.75rem; font-size: 1.25rem; font-weight: bold;" id="silence-countdown"></div>
                    </div>
                    
                    <div id="silence-result" style="display: none; margin-bottom: 1rem; padding: 0.75rem; background: var(--bg-muted); border-radius: 8px;">
                        Noise Floor: <strong id="silence-final-reading">‚Äî</strong>
                    </div>
                    
                    <button id="btn-start-silence" class="btn btn-primary btn-large" style="width: 100%;">
                        Start Silence Recording
                    </button>
                    <button id="btn-next-to-voice" class="btn btn-primary btn-large" style="display: none; width: 100%;">
                        Continue to Voice Test ‚Üí
                    </button>
                </div>
                
                <!-- Step 2: Voice -->
                <div id="quality-step-voice" style="display: none;">
                    <h3 style="margin-bottom: 0.5rem;">Step 2: Voice (10 seconds)</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                        Read this passage at your normal speaking volume:
                    </p>
                    
                    <blockquote style="background: #fffbf0; border-left: 4px solid #f0c040; padding: 1rem; margin: 0 0 1rem 0; font-style: italic; line-height: 1.6;">
                        "The rainbow appears when sunlight shines through falling rain. 
                        People look with awe at the brilliant colors stretching across the sky. 
                        Vibrant reds blend gently into warm oranges and yellows, 
                        while cool blues and deep purples fade softly at the edges.
                        Some say a pot of gold waits at the end, 
                        but no one has quite found it yet."
                    </blockquote>
                    
                    <div id="voice-pre-start" style="margin-bottom: 1rem;">
                        <button id="btn-start-voice" class="btn btn-primary btn-large" style="width: 100%;">
                            üé§ Start Recording (10 seconds)
                        </button>
                    </div>
                    
                    <div class="visualizer-container" id="voice-visualizer" style="display: none; margin-bottom: 1rem;">
                        <div class="level-bar-container" style="position: relative;">
                            <div style="position: absolute; left: 50%; right: 10%; height: 100%; background: rgba(30, 142, 62, 0.15); border-left: 2px dashed #1e8e3e; border-right: 2px dashed #1e8e3e; pointer-events: none;"></div>
                            <div id="voice-level-bar" class="level-bar"></div>
                            <span id="voice-level-text" class="level-text">0%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                            <span>Quiet</span>
                            <span id="voice-db-reading" style="font-weight: bold;">‚Äî</span>
                            <span>Loud</span>
                        </div>
                        <div style="text-align: center; margin-top: 0.75rem; font-size: 1.25rem; font-weight: bold;" id="voice-countdown"></div>
                    </div>
                    
                    <div id="voice-result" style="display: none; margin-bottom: 1rem; padding: 0.75rem; background: var(--bg-muted); border-radius: 8px;">
                        Voice: <strong id="voice-lufs-final">‚Äî</strong> ‚Ä¢ Peak: <strong id="voice-peak-final">‚Äî</strong>
                    </div>
                    
                    <button id="btn-show-results" class="btn btn-primary btn-large" style="display: none; width: 100%;">
                        View Results ‚Üí
                    </button>
                </div>
                
                <div id="quality-results" style="display: none;"></div>
            </div>
        </div>

        <!-- Screen 7: Detailed Results -->
        <div id="screen-details" class="screen">
            <a href="#" class="back-link" onclick="window.MicCheck.goBack(); return false;">‚Üê Back</a>
            
            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üìã</span>
                    <div>
                        <div class="card-title">Detailed Technical Information</div>
                        <div class="card-subtitle">What your browser exposes to websites</div>
                    </div>
                </div>
                
                <div id="details-content">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>

        <footer>
            <p>Mic Check ‚Äî A free, open-source tool</p>
            <p>No data is collected. Everything runs in your browser.</p>
            <p style="margin-top: 0.5rem;">
                <a href="https://github.com/mread/mic-check" target="_blank" rel="noopener noreferrer">GitHub</a>
                ¬∑ 
                <a href="https://github.com/mread/mic-check/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">MIT License</a>
            </p>
        </footer>
    </div>


    <script type="module" src="js/app.js"></script>
</body>
</html>
